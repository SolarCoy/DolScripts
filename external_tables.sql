-- The following code will create all the needed external tables:
DROP TABLE participant_csv;

-- The following code will create an external table for EXIT.csv file
CREATE TABLE participant_csv (PART_OBS                        VARCHAR2(240)	                    
	,GRANTEE_CODE                   VARCHAR2(4000)	 
	,SUB_GRANTEE_CODE               VARCHAR2(4000) 
	,PID                            VARCHAR2(240) 
	,APPLICATION_DATE               VARCHAR2(240) 
	,LOCAL_SITE                     VARCHAR2(4000) 
	,CASE_WORKER                    VARCHAR2(4000) 
	,LAST_NAME                      VARCHAR2(4000) 
	,FIRST_NAME                     VARCHAR2(4000) 
	,MIDDLE_INITIAL                 VARCHAR2(4000) 
	,HOME_PHONE_NUM                 VARCHAR2(4000) 
	,V_HOME_PHONE_NUM_IND           VARCHAR2(4000) 
	,STREET_ADDRESS                 VARCHAR2(4000)
	,CITY                           VARCHAR2(4000) 
	,STATE                          VARCHAR2(4000) 
	,ZIP_CODE                       VARCHAR2(4000) 
	,COUNTY                         VARCHAR2(4000) 
	,EMAIL_ADDRESS                  VARCHAR2(4000) 
	,EMR_CONTACT_NAME               VARCHAR2(4000) 
	,EMR_CONTACT_PHONE              VARCHAR2(4000) 
	,EMR_CONTACT_RELATION           VARCHAR2(4000) 
	,RESIDENT_STATE                 VARCHAR2(4000)
	,HOMELESS_IND                   VARCHAR2(4000) 
	,URBAN_RURAL_IND                VARCHAR2(4000) 
	,V_APPLICATION_DATE_IND         VARCHAR2(4000) 
	,DOB                            VARCHAR2(4000) 
	,FAMILY_NUMBER                  VARCHAR2(4000) 
	,PUBLIC_ASSISTANCE_IND          VARCHAR2(4000) 
	,SSI_IND                        VARCHAR2(4000) 
	,TANF_IND                       VARCHAR2(4000) 
	,STATE_LOCAL_WELFARE_IND        VARCHAR2(4000) 
	,FOOD_STAMPS_IND                VARCHAR2(4000) 
	,SUBSIDIZED_HOUSING_IND         VARCHAR2(4000) 
	,SSDI_IND                       VARCHAR2(4000) 
	,OTHER_ASSIST_IND               VARCHAR2(4000) 
	,OTHER_ASSIST_TEXT              VARCHAR2(4000) 
	,PRIOR_EMP_TYPE_TEXT            VARCHAR2(4000) 
	,PRIOR_EMP_SIX_MONTH_INCOME     VARCHAR2(4000) 
	,POVERTY_LEVEL_IND              VARCHAR2(4000) 
	,PRIOR_SCSEP_PARTICIPANT_IND    VARCHAR2(4000) 
	,PROJECT_TRANSFER_IND           VARCHAR2(4000) 
	,PRIOR_GRANTEE_CODE             VARCHAR2(4000) 
	,TRANSFERRED_DATE               VARCHAR2(4000) 
	,SUB_GRANTEE_CHANGE_IND         VARCHAR2(4000) 
	,PRIOR_SUB_GRANTEE_CODE         VARCHAR2(4000) 
	,SUB_GRANTEE_CHANGE_DATE        VARCHAR2(4000) 
	,GENDER                         VARCHAR2(4000) 
	,ETHNICITY_IND                  VARCHAR2(4000) 
	,RACE_AMERICAN_INDIAN_IND       VARCHAR2(4000) 
	,RACE_ASIAN_IND                 VARCHAR2(4000) 
	,RACE_BLACK_IND                 VARCHAR2(4000) 
	,RACE_PACIFIC_IND               VARCHAR2(4000) 
	,RACE_WHITE_IND                 VARCHAR2(4000) 
	,RACE_NOT_REPORTED_IND          VARCHAR2(4000) 
	,EDUCATION_LEVEL                VARCHAR2(4000) 
	,LEP_IND                        VARCHAR2(4000) 
	,LANGUAGE_NAME                  VARCHAR2(4000) 
	,OTHER_LANGUAGE_TEXT            VARCHAR2(4000) 
	,SKILLS_DEFICIENT_IND           VARCHAR2(4000) 
	,VETERAN_TEXT                   VARCHAR2(4000) 
	,DISABILITY_IND                 VARCHAR2(4000) 
	,HOMELESS_RISK_IND              VARCHAR2(4000) 
	,DISPLACED_HOMEMAKER_IND        VARCHAR2(4000) 
	,FAILED_TO_FIND_EMP_IND         VARCHAR2(4000) 
	,POOR_EMP_PROSPECTS_IND         VARCHAR2(4000) 
	,PARTICIPANT_COMMENT            VARCHAR2(4000) 
	,APPLICANT_SIG_IND              VARCHAR2(4000) 
	,APPLICANT_SIG_DATE             VARCHAR2(4000) 
	,V_APPLICANT_SIG_DATE_IND       VARCHAR2(4000) 
	,ELIGIBILITY_IND                VARCHAR2(4000) 
	,IE_AGE_IND                     VARCHAR2(4000) 
	,IE_INCOME_IND                  VARCHAR2(4000) 
	,IE_OUTSIDE_RESIDENCE_IND       VARCHAR2(4000) 
	,IE_FAILED_COMPLETE_APP_IND     VARCHAR2(4000)
	,IE_OTHER_IND                   VARCHAR2(4000) 
	,IE_OTHER_TEXT                  VARCHAR2(4000) 
	,IE_ACTION_ONE_STOP_IND         VARCHAR2(4000) 
	,IE_ACTION_SOCIAL_SERVICE_IND   VARCHAR2(4000) 
	,IE_ACTION_OTHER_PROJ_IND       VARCHAR2(4000) 
	,IE_ACTION_UNSUB_EMP_IND        VARCHAR2(4000) 
	,IE_ACTION_OTHER_IND            VARCHAR2(4000) 
	,IE_ACTION_OTHER_TEXT           VARCHAR2(4000) 
	,WAITING_LIST_IND               VARCHAR2(4000) 
	,CSA_IND                        VARCHAR2(4000)
	--,RECOVERY_ACT_IND              VARCHAR2(4000) 
	--,RECOVERY_ACT_MOVE_DATE        VARCHAR2(4000)  
	,SLOT_COUNTY                    VARCHAR2(4000) 
	,CO_ENROLL_WIA_IND              VARCHAR2(4000) 
	,CO_ENROLL_EMP_SERVICE_IND      VARCHAR2(4000) 
	,CO_ENROLL_ADULT_EDU_IND        VARCHAR2(4000) 
	,CO_ENROLL_COLLEGE_IND          VARCHAR2(4000) 
	,CO_ENROLL_OTHER_IND            VARCHAR2(4000) 
	,CO_ENROLL_OTHER_TEXT           VARCHAR2(4000) 
	,CO_ENROLL_NONE_IND             VARCHAR2(4000) 
	,ORIENTATION_DATE               VARCHAR2(4000) 
	,LAST_PHYSICAL_DATE             VARCHAR2(4000) 
	,LAST_IEP_DATE                  VARCHAR2(4000) 
	,JOB_INTEREST_1                 VARCHAR2(4000) 
	,JOB_INTEREST_2                 VARCHAR2(4000) 
	,JOB_INTEREST_3                 VARCHAR2(4000) 
	,COMMENT_TEXT                   VARCHAR2(4000) 
	,DIRECTOR_SIG_IND               VARCHAR2(4000)
	,ELIGIBILITY_DET_DATE           VARCHAR2(4000) 
	,V_ELIGIBILITY_DET_DATE_IND     VARCHAR2(4000) 
	,RECERT_FAMILY_NUMBER           VARCHAR2(4000) 
	,RECERT_SIX_MONTH_INCOME        VARCHAR2(4000) 
	,RECERT_PARTICIPANT_SIG_IND     VARCHAR2(4000) 
	,RECERT_ELIGIBILITY_IND         VARCHAR2(4000) 
	,RECERT_IE_INCOME_IND           VARCHAR2(4000) 
	,RECERT_IE_INCOMPLETE_APP_IND   VARCHAR2(4000) 
	,RECERT_IE_OTHER_IND            VARCHAR2(4000) 
	,RECERT_IE_OTHER_TEXT           VARCHAR2(4000) 
	,RECERT_DIRECTOR_SIG_IND        VARCHAR2(4000) 
	,RECERT_DIRECTOR_SIG_DATE       VARCHAR2(4000) 
	,SEVERE_DISABILITY_IND          VARCHAR2(4000) 
	,SEVERE_DISABILITY_DATE         VARCHAR2(4000) 
	,FRAIL_IND                      VARCHAR2(4000) 
	,FRAIL_DATE                     VARCHAR2(4000) 
	,NOT_RECEIVING_SS_II_IND        VARCHAR2(4000) 
	,NOT_RECEIVING_SS_II_DATE       VARCHAR2(4000) 
	,SEVERELY_LTD_EMP_PROSPECTS_IND VARCHAR2(4000) 
	,SEV_LTD_EMP_PROSPECTS_DATE     VARCHAR2(4000)
	,LEP_WAIVER_IND                 VARCHAR2(4000)
	,LEP_WAIVER_DATE                VARCHAR2(4000)
	,SKILLS_DEFICIENT_WAIVER_IND    VARCHAR2(4000)
	,SKILLS_DEFICIENT_WAIVER_DATE   VARCHAR2(4000)
	,RECERT_COMMENT_TEXT            VARCHAR2(4000)
)
ORGANIZATION EXTERNAL (
  TYPE oracle_loader
  DEFAULT DIRECTORY SPARQ_DIR
  ACCESS PARAMETERS
  (RECORDS DELIMITED BY NEWLINE
   SKIP 1
   FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
   MISSING FIELD VALUES ARE NULL)
  LOCATION ('Participant.csv')
);


-- The following code will create an external table for EXIT.csv file
drop table exit_csv;

CREATE TABLE exit_csv (EXIT_OBS   VARCHAR2(240)                    
	,GRANTEE_CODE                   VARCHAR2(4000)
	,SUB_GRANTEE_CODE               VARCHAR2(4000)
	,PID                            VARCHAR2(240)
	,APPLICATION_DATE               VARCHAR2(240)
	,EXIT_REASON_UNSUB              VARCHAR2(4000)
	,EXIT_REASON_OTHER              VARCHAR2(4000)
	,NON_EXIT_REASON                VARCHAR2(4000)
	,TRANSFERRED_GRANTEE_CODE       VARCHAR2(4000)
	,EXIT_DATE                      VARCHAR2(4000)
	,PARTICIPANT_SIG_IND            VARCHAR2(4000)
	,PARTICIPANT_SIG_DATE           VARCHAR2(4000)
	,EXCLUSION_AFTER_EXIT           VARCHAR2(4000)
	,EXCLUSION_DATE                 VARCHAR2(4000)
	,EXIT_COMMENT_TEXT              VARCHAR2(4000)
)
ORGANIZATION EXTERNAL (
  TYPE oracle_loader
  DEFAULT DIRECTORY SPARQ_DIR
  ACCESS PARAMETERS
  (RECORDS DELIMITED BY NEWLINE
   SKIP 1
   FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
   MISSING FIELD VALUES ARE NULL)
  LOCATION ('Exit.csv')
);



-- The following code will create an external table for UE.csv file
drop table ue_csv;

CREATE TABLE ue_csv (UE_OBS           VARCHAR2(240)              
	,GRANTEE_CODE                   VARCHAR2(4000)
	,SUB_GRANTEE_CODE               VARCHAR2(4000)
	,PID                            VARCHAR2(240)
	,APPLICATION_DATE               VARCHAR2(240)
	,ORG_NAME                       VARCHAR2(4000)
	,O_STREET_ADDRESS               VARCHAR2(4000)
	,O_CITY                         VARCHAR2(4000)
	,O_STATE                        VARCHAR2(4000)
	,O_ZIP_CODE                     VARCHAR2(4000)
	,O_FEIN                         VARCHAR2(4000)
	,V_O_FEIN_IND                   VARCHAR2(4000)
	,O_ORG_TYPE                     VARCHAR2(4000)
	,HOST_AGENCY_IND                VARCHAR2(4000)
	,OJE_IND                        VARCHAR2(4000)
	,ORG_SITE_NAME                  VARCHAR2(4000)
	,AVAILABILITY_IND               VARCHAR2(4000)
	,CON_LAST_NAME                  VARCHAR2(4000)
	,CON_FIRST_NAME                 VARCHAR2(4000)
	,CON_STREET_ADDRESS             VARCHAR2(4000)
	,CON_STREET_ADDRESS_2           VARCHAR2(4000)
	,CON_CITY                       VARCHAR2(4000)
	,CON_STATE                      VARCHAR2(4000)
	,CON_ZIP_CODE                   VARCHAR2(4000)
	,CON_TITLE_TEXT                 VARCHAR2(4000)
	,V_CON_TITLE_TEXT_IND           VARCHAR2(4000)
	,CON_SALUTATION_TEXT            VARCHAR2(4000)
	,CON_PHONE_NUM                  VARCHAR2(4000)
	,CON_FAX_NUM                    VARCHAR2(4000)
	,CON_EMAIL_ADDRESS              VARCHAR2(4000)
	,SUP_LAST_NAME                  VARCHAR2(4000)
	,SUP_FIRST_NAME                 VARCHAR2(4000)
	,SUP_STREET_ADDRESS             VARCHAR2(4000)
	,SUP_STREET_ADDRESS_2           VARCHAR2(4000)
	,SUP_CITY                       VARCHAR2(4000)
	,SUP_STATE                      VARCHAR2(4000)
	,SUP_ZIP_CODE                   VARCHAR2(4000)
	,SUP_TITLE_TEXT                 VARCHAR2(4000)
	,SUP_SALUTATION_TEXT            VARCHAR2(4000)
	,SUP_PHONE_NUM                  VARCHAR2(4000)
	,SUP_FAX_NUM                    VARCHAR2(4000)
	,SUP_EMAIL_ADDRESS              VARCHAR2(4000)
	,START_DATE                     VARCHAR2(4000)
	,V_START_DATE_IND               VARCHAR2(4000)
	,END_DATE                       VARCHAR2(4000)
	,V_END_DATE_IND                 VARCHAR2(4000)
	,STARTING_HOURLY_RATE           VARCHAR2(4000)
	,V_STARTING_HOURLY_RATE_IND     VARCHAR2(4000)
	,BENEFITS_HEALTH_INS_IND        VARCHAR2(4000)
	,BENEFITS_SICK_LEAVE_IND        VARCHAR2(4000)
	,BENEFITS_P_SHARING_IND         VARCHAR2(4000)
	,BENEFITS_VACATION_IND          VARCHAR2(4000)
	,BENEFITS_TRANS_IND             VARCHAR2(4000)
	,BENEFITS_RM_B_IND              VARCHAR2(4000)
	,BENEFITS_OTHER_IND             VARCHAR2(4000)
	,BENEFITS_OTHER_TEXT            VARCHAR2(4000)
	,BENEFITS_NONE_IND              VARCHAR2(4000)
	,EXPECTED_FULL_PART_IND         VARCHAR2(4000)
	,EXPECTED_PART_HOURS            VARCHAR2(4000)
	,SERVICE_ASSIGNMENT_TITLE       VARCHAR2(4000)
	,JOB_NAME                       VARCHAR2(4000)
	,HGI_NAME                       VARCHAR2(4000)
	,TRAINING_RELATED_IND           VARCHAR2(4000)
	,SUB_GRANTEE_SERVICE_IND        VARCHAR2(4000)
	,COMMENT_TEXT                   VARCHAR2(4000)
	,CS_SURVEY_NUM_1                VARCHAR2(4000)
	,CS_SURVEY_DATE_1               VARCHAR2(4000)
	,CS_SURVEY_NUM_2                VARCHAR2(4000)
	,CS_SURVEY_DATE_2               VARCHAR2(4000)
	,CS_SURVEY_NUM_3                VARCHAR2(4000)
	,CS_SURVEY_DATE_3               VARCHAR2(4000)
	,RETURNED_TO_PROGRAM_IND        VARCHAR2(4000)
	,SCSEP_SERVICES_90_DAYS_IND     VARCHAR2(4000)
	,FIRST_QTR_FU_COMPLETED_DATE    VARCHAR2(4000)
	,FIRST_QTR_WAGES_TEXT           VARCHAR2(4000)
	,FIRST_QTR_WAGES_EXCL_TEXT      VARCHAR2(4000)
	,FU_2ND_3RD_QTR_COMPLETED_DATE  VARCHAR2(4000)
	,SECOND_QTR_WAGES_TEXT          VARCHAR2(4000)
	,SECOND_QTR_WAGES_EXCL_TEXT     VARCHAR2(4000)
	,SECOND_QTR_WAGES_AMT           VARCHAR2(4000)
	,THIRD_QTR_WAGES_TEXT           VARCHAR2(4000)
	,THIRD_QTR_WAGES_EXCL_TEXT      VARCHAR2(4000)
	,THIRD_QTR_WAGES_AMT            VARCHAR2(4000)
	,FOURTH_QTR_FU_COMPLETED_DATE   VARCHAR2(4000)
	,FOURTH_QTR_WAGES_TEXT          VARCHAR2(4000)
	,FOURTH_QTR_WAGES_EXCL_TEXT     VARCHAR2(4000)
	,CS_FU_COMMENT_TEXT             VARCHAR2(4000)
)
ORGANIZATION EXTERNAL (
  TYPE oracle_loader
  DEFAULT DIRECTORY SPARQ_DIR
  ACCESS PARAMETERS
  (RECORDS DELIMITED BY NEWLINE
   SKIP 1
   FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
   MISSING FIELD VALUES ARE NULL)
  LOCATION ('UE.csv')
);


-- The following code will create an external table for CSA.csv file
DROP TABLE csa_csv;

CREATE TABLE csa_csv(CSA_OBS          VARCHAR2(240)              
	,GRANTEE_CODE                   VARCHAR2(4000)
	,SUB_GRANTEE_CODE               VARCHAR2(4000)
	,PID                            VARCHAR2(240)
	,APPLICATION_DATE               VARCHAR2(240)
	,ASSIGNMENT_DATE                VARCHAR2(4000)
	,ORG_NAME                       VARCHAR2(4000)
	,O_STREET_ADDRESS               VARCHAR2(4000)
	,O_CITY                         VARCHAR2(4000)
	,O_STATE                        VARCHAR2(4000)
	,O_ZIP_CODE                     VARCHAR2(4000)
	,O_FEIN                         VARCHAR2(4000)
	,V_O_FEIN_IND                   VARCHAR2(4000)
	,O_ORG_TYPE                     VARCHAR2(4000)
	,HA_AGREEMENT_DATE              VARCHAR2(4000)
	,HA_MONITORING_DATE             VARCHAR2(4000)
	,ORG_SITE_NAME                  VARCHAR2(4000)
	,JOB_CODE_1                     VARCHAR2(4000)
	,JOB_CODE_2                     VARCHAR2(4000)
	,JOB_CODE_3                     VARCHAR2(4000)
	,AVAILABILITY_IND               VARCHAR2(4000)
	,CON_LAST_NAME                  VARCHAR2(4000)
	,CON_FIRST_NAME                 VARCHAR2(4000)
	,CON_STREET_ADDRESS             VARCHAR2(4000)
	,CON_STREET_ADDRESS_2           VARCHAR2(4000)
	,CON_CITY                       VARCHAR2(4000)
	,CON_STATE                      VARCHAR2(4000)
	,CON_ZIP_CODE                   VARCHAR2(4000)
	,CON_TITLE_TEXT                 VARCHAR2(4000)
	,V_CON_TITLE_TEXT_IND           VARCHAR2(4000)
	,CON_SALUTATION_TEXT            VARCHAR2(4000)
	,CON_PHONE_NUM                  VARCHAR2(4000)
	,CON_FAX_NUM                    VARCHAR2(4000)
	,CON_EMAIL_ADDRESS              VARCHAR2(4000)
	,SUP_LAST_NAME                  VARCHAR2(4000)
	,SUP_FIRST_NAME                 VARCHAR2(4000)
	,SUP_STREET_ADDRESS             VARCHAR2(4000)
	,SUP_STREET_ADDRESS_2           VARCHAR2(4000)
	,SUP_CITY                       VARCHAR2(4000)
	,SUP_STATE                      VARCHAR2(4000)
	,SUP_ZIP_CODE                   VARCHAR2(4000)
	,SUP_TITLE_TEXT                 VARCHAR2(4000)
	,SUP_SALUTATION_TEXT            VARCHAR2(4000)
	,SUP_PHONE_NUM                  VARCHAR2(4000)
	,SUP_FAX_NUM                    VARCHAR2(4000)
	,SUP_EMAIL_ADDRESS              VARCHAR2(4000)
	,SUP_FUNDING_SOURCE             VARCHAR2(4000)
	,SUP_FUNDING_RATE               VARCHAR2(4000)
	,SUP_AVG_HOURS_WEEK             VARCHAR2(4000)
	,V_ASSIGNMENT_DATE_IND          VARCHAR2(4000)
	,START_DATE                     VARCHAR2(4000)
	,END_DATE                       VARCHAR2(4000)
	,STARTING_HOURLY_RATE           VARCHAR2(4000)
	,V_STARTING_HOURLY_RATE_IND     VARCHAR2(4000)
	,ASSIGNED_HOURS_WEEK            VARCHAR2(4000)
	,SCHEDULE_TEXT                  VARCHAR2(4000)
	,SAFETY_CONSULTATION_DATE       VARCHAR2(4000)
	,SERVICE_ASSIGNMENT_CODE        VARCHAR2(4000)
	,SERVICE_ASSIGNMENT_OTHER       VARCHAR2(4000)
	,SERVICE_ASSIGNMENT_TITLE       VARCHAR2(4000)
	,JOB_NAME                       VARCHAR2(4000)
	,COMPENSATION_CODE              VARCHAR2(4000)
	,TOT_HOURS_Q1                   VARCHAR2(4000)
	,V_TOT_HOURS_Q1_IND             VARCHAR2(4000)
	,TOT_HOURS_Q2                   VARCHAR2(4000)
	,V_TOT_HOURS_Q2_IND             VARCHAR2(4000)
	,TOT_HOURS_Q3                   VARCHAR2(4000)
	,V_TOT_HOURS_Q3_IND             VARCHAR2(4000)
	,TOT_HOURS_Q4                   VARCHAR2(4000)
	,V_TOT_HOURS_Q4_IND             VARCHAR2(4000)
	,GENERAL_TRAINING_IND           VARCHAR2(4000)
	,SPECIALIZED_TRAINING_IND       VARCHAR2(4000)
	,OJE_IND                        VARCHAR2(4000)
	,OTHER_TRAINING_IND             VARCHAR2(4000)
	,CSA_OTHER_TRAINING_TEXT        VARCHAR2(4000)
	,TRAINING_NONE_IND              VARCHAR2(4000)
	,TOT_HOURS_TRAINING_Q1          VARCHAR2(4000)
	,TOT_HOURS_TRAINING_Q2          VARCHAR2(4000)
	,TOT_HOURS_TRAINING_Q3          VARCHAR2(4000)
	,TOT_HOURS_TRAINING_Q4          VARCHAR2(4000)
	,COMMENT_TEXT                   VARCHAR2(4000)
	,TP_ORG_NAME                    VARCHAR2(4000)
	,TP_STREET_ADDRESS              VARCHAR2(4000)
	,TP_CITY                        VARCHAR2(4000)
	,TP_STATE                       VARCHAR2(4000)
	,TP_ZIP_CODE                    VARCHAR2(4000)
	,TP_AVAILABILITY_IND            VARCHAR2(4000)
	,TP_LAST_NAME                   VARCHAR2(4000)
	,TP_FIRST_NAME                  VARCHAR2(4000)
	,TP_CON_STREET_ADDRESS          VARCHAR2(4000)
	,TP_CON_STREET_ADDRESS_2        VARCHAR2(4000)
	,TP_CON_CITY                    VARCHAR2(4000)
	,TP_CON_STATE                   VARCHAR2(4000)
	,TP_CON_ZIP_CODE                VARCHAR2(4000)
	,TP_TITLE_TEXT                  VARCHAR2(4000)
	,TP_SALUTATION_TEXT             VARCHAR2(4000)
	,TP_PHONE_NUM                   VARCHAR2(4000)
	,TP_FAX_NUM                     VARCHAR2(4000)
	,TP_EMAIL_ADDRESS               VARCHAR2(4000)
	,TP_GENERAL_TRAINING_IND        VARCHAR2(4000)
	,TP_SPECIALIZED_TRAINING_IND    VARCHAR2(4000)
	,TP_OJE_IND                     VARCHAR2(4000)
	,TP_OTHER_TRAINING_IND          VARCHAR2(4000)
	,TP_OTHER_TRAINING_TEXT         VARCHAR2(4000)
	,TP_JOB_NAME                    VARCHAR2(4000)
	,TRAINING_WC_CODE               VARCHAR2(4000)
	,TP_START_DATE                  VARCHAR2(4000)
	,TP_END_DATE                    VARCHAR2(4000)
	,AVG_TRAINING_HOURS_WEEK        VARCHAR2(4000)
	,AVG_TRAINING_CSA_HOURS_WEEK    VARCHAR2(4000)
	,TRAINING_WAGES_PAID_TYPE       VARCHAR2(4000)
	,REIMBURSED_EMP_TRAINING_RATE   VARCHAR2(4000)
	,TP_STARTING_HOURLY_RATE        VARCHAR2(4000)
	,TOT_PAID_TRAINING_WAGES        VARCHAR2(4000)
	,TOT_TRAINING_AMOUNT            VARCHAR2(4000)
	,TP_COMMENT_TEXT                VARCHAR2(4000)
)
ORGANIZATION EXTERNAL (
  TYPE oracle_loader
  DEFAULT DIRECTORY SPARQ_DIR
  ACCESS PARAMETERS
  (RECORDS DELIMITED BY NEWLINE
   SKIP 1
   FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
   MISSING FIELD VALUES ARE NULL)
  LOCATION ('CSA.csv')
);

-- The following code will create an external table for EXIT.csv file
drop table break_csv;

CREATE TABLE break_csv (BREAK_OBS        VARCHAR2(240)              
	,GRANTEE_CODE                   VARCHAR2(4000)
	,SUB_GRANTEE_CODE               VARCHAR2(4000)
	,PID                            VARCHAR2(240)
	,APPLICATION_DATE               VARCHAR2(240)
	,ASSIGNMENT_DATE                VARCHAR2(4000)
	,BREAK_START_DATE               VARCHAR2(4000)
	,BREAK_EXPECTED_END_DATE        VARCHAR2(4000)
	,BREAK_END_DATE                 VARCHAR2(4000)
	,BREAK_REASON                   VARCHAR2(4000)
	,BREAK_OTHER_TEXT               VARCHAR2(4000)
	,BREAK_COMMENT_TEXT             VARCHAR2(4000)
)
ORGANIZATION EXTERNAL (
  TYPE oracle_loader
  DEFAULT DIRECTORY SPARQ_DIR
  ACCESS PARAMETERS
  (RECORDS DELIMITED BY NEWLINE
   SKIP 1
   FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
   MISSING FIELD VALUES ARE NULL)
  LOCATION ('Break.csv')
);


DROP TABLE PARTICIPANT_FILE;

CREATE TABLE PARTICIPANT_FILE AS
SELECT *
FROM PARTICIPANT_CSV
WHERE ROWNUM < 1;

CREATE INDEX PARTICIPANT_FILE_IND01 
ON PARTICIPANT_FILE(PID, APPLICATION_DATE) 
TABLESPACE SPARQ_INDEX;

